用普通话讲解密码安全

最近几天邮箱里的垃圾邮件明显增加，其中有一封邮件的收件人姓名竟然是我以前用过的一个密码，令我大为惊骇。不久之后，在网上就看到了最近几个较大的社交网站被人攻击导致用户信息泄露的传言，看来我也是中招了。随后我也看了一些关于安全方面的文章，比如@caoz的 谈谈近期的安全事件，但其中有些术语不那么容易让普通人理解，我争取使用普通平实的语言来讲解一下和密码设置有关的安全问题。

登录网站以后都发生了什么？

我们平时会登陆许多网站，比如开心、人人、微博、淘宝、支付宝、果壳之类。在我们输入了用户名/密码，点击登录按钮以后都发生了什么呢？不妨将这些网站看作是一个有门卫把守的俱乐部，我走到门前，门卫拦住我，连问我三个哲学问题：“你是谁”“你从哪里来”“你到哪里去”。我赶忙报上姓名（用户名），递上邀请函（密码），说我是来参加俱乐部活动的。于是门卫在邀请名单上寻找了一番，又仔细核对了我的邀请函，将我放了进去。

网站也是一样，他们有一个记录簿来记录我的用户名和密码之间的关系。如果满足这个关系，就可以进入网站，并且认证我的身份。最简单的，是一个数据库，上面有用户名和密码的原文，比如姓名：金色葡萄，密码：1234。这种保存方法叫做“明文”，明明白白文字。以明文记录密码和传递密码是非常不负责的行为。如果数据库丢失或者网站内部员工居心不良，坏人就可以直接看到我的用户名和密码，能够冒用我的身份。用明文存储密码，不是技术太差，就是居心叵测。

下面有几个简单的方法来推测网站是否用安全的方法来存储密码：

* 输入错误的密码，负责的网站是会告诉你“用户名和密码不匹配”，而那些直接告诉你“密码错误”的站点，最好要小心了。
* 选择“找回密码”，如果网站发来的恢复密码email之中是您密码的原文，那么这也是给非常不靠谱的网站。

网站如何保护用户密码库？

网站会把存储用户密码信息的数据库藏起来，不能随便被找到。但是这毕竟是个常用的数据库，每个登录的用户都要去查询一下。放在网络上这个数据库就有可能被偷走，就是『爆库』。据说“国内有点影响力的网站，2/3都被爆过库”，所以看来被偷走是迟早的事情。如果密码是以原文形式保存在数据库中就危险了。

既然明文存储密码是不安全的。那么网站是如何保存用户密码库呢？直接可以想到的就是加密，本来的记录是“金色葡萄-1234”，我们把它重新对应一下，变成“金色葡萄-2345”不就行了。把1234的每一个数字+1变成2345。不行，这种是可逆的加密，从2345很容易就推出1234了。要使用HASH运算来将用户的密码转换成另一串代码保存起来，比如密码是'1234'，经过hash运算，可能生成的是172615877915217560892406575915100721237。HASH运算的一个特征是单向运算，从1234算出172615877915217560892406575915100721237很容易，而从172615877915217560892406575915100721237要反解出1234是非常困难的。比较有名的HASH算法有MD5, SHA-1, SHA-2……很多网站都是把密码经过MD5运算以后保存起来的。我们把自己的密码放在这样的网站里就安全了吧。

碰撞库

仍然是不够安全的。虽然HASH是单向运算，很难从HASH值反解出密码来。但是如果记录了足够多的正向运算的因果关系，比如：

1234=>172615877915217560892406575915100721237
5678=>137321895456499924882127491134507012282
abcd=>301716283811389038011477436469853762335
……

那么偷取的密码库之中，发现有172615877915217560892406575915100721237时，坏人就可以知道密码正是1234，而不必花费长时间去反解HASH算法。这种方法叫做碰撞，记录这种对应关系的数据库叫做碰撞库。@caoz举了个栗子 cmd5.com 推荐看一下其中的破解范围。

对于网站服务商而言，碰撞库是非常可怕的。通过碰撞库，坏人可以获得相当多人的密码，足以把网站搅得鸡犬不宁。看看这个碰撞库中所描述的破解范围：

 * 1-6位大小写字母+数字+特殊字符，收录100%
 * 7位小写字母+数字，收录100%
 * 8位小写字母，收录100%
 * 8位小写字母+数字，已收录50%，正在添加
 * 8-11位数字，收录100%

其中也许有吹牛的成分，但是您的密码是否也属于其中呢？

社工库

不过很多人会想，反正我在这个网站上也没存储什么秘密，也没给这个网站付过费，密码丢了就丢了呗。其实不然，对于人类，我们根本记不住多少密码。想想您是否在多个网站都是用同样的用户名和密码呢？甚至，您可能登录微博的那个密码与支付宝的那个支付密码恰好也是一个吧，还有您的银行卡密码。如果是这样，请您面壁一会。针对我们的这个弱点，黑客们还有一个叫做社会工程学库的工具，简称社工库，专门记录以前被爆库的数据。

有经验的黑客会从社工库里面取出数据，去知名网站上测试。这个过程是用计算机高速进行的。您丢掉了一把钥匙，然后就出现了一个机器人在每个高档/知名小区的门锁上插着试，每秒钟成千上万个门的测试。您在开心网或者微博上的密码或许已经丢失了，现在可能正被人拿到QQ甚至支付宝上测试呢。怎么样，汗都下来了吧。

正确的密码习惯

对于网站服务商，我们普通用户无法控制。即使国外一些知名的安全网站，也有被爆库的经历，比如在2011年5月，密码管理网站LastPass就被爆库了，他们会很谨慎的发来邮件，请用户注意修改密码。

Dear LastPass User,

On May 3rd, we discovered suspicious network activity on the LastPass internal network. After investigating, we determined that it was possible that a limited amount of data was accessed. All LastPass accounts were quickly locked down, preventing access from unknown locations. We then announced our findings and course of action on our blog and spoke with the media.

As you know, LastPass does not have access to your master password or your confidential data. To further secure your account, LastPass now requires you to verify your identity when logging in. You will be prompted to validate your email if you try to log in from a new location. This prompt will continue to appear until you change your master password or indicate that you are comfortable with the strength of your master password.

Please visit https://lastpass.com/status for more information.

Thanks, The LastPass Team

但我好像从未收到过国内网站的任何警告邮件，也许是国内服务商自己都可以解决吧，毕竟“国内有点影响力的网站，2/3都被爆过库”也只是传言而已。我们作为普通用户，只能在我们的信息被窃取之后能够将损失和危险降到最低。我对于普通用户的建议是：

* 设定足够长度的密码。
* 每个网站使用不同的密码。
* 定期修改密码

对于定期修改密码，也有不同的意见，

@hengdm认为 ：
﻿﻿经常更换密码并＊不会＊更安全，尽管这听起来不合情理。更换密码的安全策略是因为：
A.防止密码被盗后能被长期监控以等待时机干一大票 
B.一系列管理密码需要被多人同时知晓时，避免人员变更或某人无意中泄露密码规则后发生A情况

定期更换密码是否安全，如果是以下情况则意义不大：
A更换周期超过90天 
B多个密码轮换使用 
C变化过于简单，如只改变结尾计数或调换字串 
D只更换密码不更换规则 
E当前密码已失窃更换过程可能被监控 
F更换密码需以明文形式告知小组

鉴于上两推的情况和要求比较苛刻，加之密码更换过程本身就是风险（很可能被监控），最好不要定期更换，除非：
A经常在公开场合输入密码，比如刷信用卡密码、手机开机密码 
B有任何失窃或规则泄露的迹象 
C需要与多人共享密码
﻿
不过，我个人认为，考虑到使用国内服务，即使密码泄露也不一定被告知。可以做最坏的打算，考虑默认为一段时间就会失窃。

如果对密码学更有兴趣的，推荐欧姆社的《漫画密码》，看着漫画就明白了。
对于密码设置的技巧，参考《你的密码安全吗？小心那些隐藏的陷阱》
我们还在完善一款很帅的﻿密码生成管理装置。

==update 2011.12.21==
@yegle 今日有黑客在网上公开了CSDN网站用户数据库，包括600余万个明文的注册邮箱帐号和密码。CSDN是国内最大的程序员网站，请广大程序员务必重视并尽快修改密码，包括CSDN帐号密码，以及采用相同注册邮箱和密码的其他网络帐号，如邮箱、微博、购物网站、聊天软件等帐号，以免蒙受盗号损失！

@cosbeta http://0bad.com/csdn.php 去这里查询自己的账户在不在csdn的泄漏文件中吧,防止滥用，密码已经省略掉几位
WTF, EOF